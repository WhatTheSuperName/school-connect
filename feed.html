// ===== –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê –õ–ï–ù–¢–´ =====

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
const AppState = {
    currentUser: null,
    posts: [],
    friends: [],
    messages: [],
    photos: [],
    events: [],
    onlineFriends: [],
    currentTab: 'feed',
    isLoading: false
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', function() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    loadCurrentUser();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–∫–ª–∞–¥–∫–∏
    initTabs();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤
    initPostCreation();
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    loadInitialData();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∏—Å–∫
    initSearch();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    initNotifications();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    initUserMenu();
});

// ===== –ó–ê–ì–†–£–ó–ö–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø =====
function loadCurrentUser() {
    // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ sessionStorage (–≤—Ö–æ–¥)
    let sessionData = sessionStorage.getItem('schoolspace_session');
    
    if (sessionData) {
        try {
            AppState.currentUser = JSON.parse(sessionData);
        } catch(e) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Å—Å–∏–∏:', e);
            redirectToLogin();
        }
    } else {
        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
        let userData = localStorage.getItem('schoolspace_user');
        
        if (userData) {
            try {
                const user = JSON.parse(userData);
                AppState.currentUser = {
                    username: user.username,
                    fullName: user.fullName,
                    class: user.class,
                    loggedIn: true,
                    timestamp: new Date().toISOString()
                };
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ sessionStorage
                sessionStorage.setItem('schoolspace_session', JSON.stringify(AppState.currentUser));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                updateUserUI();
            } catch(e) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', e);
                redirectToLogin();
            }
        } else {
            // –ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≤—Ö–æ–¥
            redirectToLogin();
        }
    }
}

function redirectToLogin() {
    setTimeout(() => {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
        window.location.href = 'login.html';
    }, 100);
}

function updateUserUI() {
    if (AppState.currentUser) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        const userNameElements = document.querySelectorAll('.user-name-small, .profile-name');
        userNameElements.forEach(el => {
            if (el.classList.contains('profile-name')) {
                el.textContent = AppState.currentUser.fullName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            } else {
                el.textContent = AppState.currentUser.username || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            }
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å
        const classElements = document.querySelectorAll('.user-class-small, .profile-class');
        classElements.forEach(el => {
            el.textContent = `${AppState.currentUser.class || '–ù–µ —É–∫–∞–∑–∞–Ω'} –∫–ª–∞—Å—Å, –®–∫–æ–ª–∞ ‚Ññ5`;
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä—ã
        const avatarElements = document.querySelectorAll('.user-avatar-small, .profile-avatar-large, .post-author-avatar');
        avatarElements.forEach(el => {
            const name = AppState.currentUser.fullName || AppState.currentUser.username || 'User';
            el.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=6366f1&color=fff&size=150`;
        });
    }
}

// ===== –í–ö–õ–ê–î–ö–ò =====
function initTabs() {
    const tabButtons = document.querySelectorAll('.nav-item[data-tab]');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            tabButtons.forEach(btn => btn.classList.remove('active'));
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
            this.classList.add('active');
            
            // –ü–æ–ª—É—á–∞–µ–º ID –≤–∫–ª–∞–¥–∫–∏
            const tabId = this.getAttribute('data-tab');
            AppState.currentTab = tabId;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            const targetTab = document.getElementById(`${tabId}-tab`);
            if (targetTab) {
                targetTab.classList.add('active');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
                loadTabData(tabId);
            }
        });
    });
}

function loadTabData(tabId) {
    switch(tabId) {
        case 'feed':
            if (AppState.posts.length === 0) {
                loadPosts();
            }
            break;
        case 'friends':
            if (AppState.friends.length === 0) {
                loadFriends();
            }
            break;
        case 'messages':
            if (AppState.messages.length === 0) {
                loadMessages();
            }
            break;
        case 'photos':
            if (AppState.photos.length === 0) {
                loadPhotos();
            }
            break;
    }
}

// ===== –°–û–ó–î–ê–ù–ò–ï –ü–û–°–¢–û–í =====
function initPostCreation() {
    const postInput = document.getElementById('postInput');
    const submitBtn = document.getElementById('submitPostBtn');
    
    if (!postInput || !submitBtn) return;
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞
    postInput.addEventListener('input', function() {
        submitBtn.disabled = this.value.trim().length === 0;
    });
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter (Shift+Enter –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)
    postInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            if (!submitBtn.disabled) {
                createPost();
            }
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
    submitBtn.addEventListener('click', createPost);
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –æ–ø—Ü–∏–π
    const postOptions = document.querySelectorAll('.post-option');
    postOptions.forEach(option => {
        option.addEventListener('click', function() {
            const type = this.getAttribute('data-type');
            handlePostOption(type);
        });
    });
}

function handlePostOption(type) {
    switch(type) {
        case 'photo':
            alert('–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ç–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è');
            break;
        case 'video':
            alert('–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è');
            break;
        case 'event':
            alert('–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è');
            break;
        case 'poll':
            alert('–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è');
            break;
    }
}

function createPost() {
    const postInput = document.getElementById('postInput');
    const submitBtn = document.getElementById('submitPostBtn');
    
    const content = postInput.value.trim();
    if (!content || !AppState.currentUser) return;
    
    // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ü—É–±–ª–∏–∫–∞—Ü–∏—è...';
    
    // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ø–æ—Å—Ç–∞
    const newPost = {
        id: Date.now(),
        author: {
            name: AppState.currentUser.fullName || AppState.currentUser.username,
            class: AppState.currentUser.class,
            avatar: `https://ui-avatars.com/api/?name=${encodeURIComponent(AppState.currentUser.fullName || AppState.currentUser.username)}&background=6366f1&color=fff&size=150`
        },
        content: content,
        timestamp: new Date().toISOString(),
        likes: 0,
        comments: [],
        liked: false
    };
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ –º–∞—Å—Å–∏–≤–∞
    AppState.posts.unshift(newPost);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º UI
    renderPosts();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ—Å—Ç–æ–≤
    updatePostsCount();
    
    // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
    postInput.value = '';
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    showNotification('–ü–æ—Å—Ç —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!', 'success');
    
    // –ü—Ä—è—á–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—É—Å—Ç–æ–π –ª–µ–Ω—Ç–µ
    const emptyFeed = document.getElementById('emptyFeed');
    if (emptyFeed) {
        emptyFeed.style.display = 'none';
    }
}

// ===== –ó–ê–ì–†–£–ó–ö–ê –ü–û–°–¢–û–í =====
function loadPosts() {
    const loadingIndicator = document.getElementById('loadingIndicator');
    const postsContainer = document.getElementById('postsContainer');
    const emptyFeed = document.getElementById('emptyFeed');
    
    if (loadingIndicator) loadingIndicator.classList.add('active');
    
    // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
    setTimeout(() => {
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ—Å—Ç—ã, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
        if (AppState.posts.length === 0) {
            generateSamplePosts();
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–º –ø–æ—Å—Ç—ã
        renderPosts();
        
        if (loadingIndicator) loadingIndicator.classList.remove('active');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—É—Å—Ç–æ–π –ª–µ–Ω—Ç–µ, –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤
        if (postsContainer && emptyFeed) {
            if (AppState.posts.length === 0) {
                emptyFeed.style.display = 'block';
                postsContainer.innerHTML = '';
            } else {
                emptyFeed.style.display = 'none';
            }
        }
    }, 1000);
}

function generateSamplePosts() {
    const samplePosts = [
        {
            id: 1,
            author: {
                name: "–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
                class: "–£—á–∏—Ç–µ–ª—å –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏",
                avatar: "https://ui-avatars.com/api/?name=–ú–∞—Ä–∏—è+–ü–µ—Ç—Ä–æ–≤–∞&background=dc143c&color=fff&size=150"
            },
            content: "–ù–∞–ø–æ–º–∏–Ω–∞—é, —á—Ç–æ –∑–∞–≤—Ç—Ä–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –∞–ª–≥–µ–±—Ä–µ. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ–º—ã: –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –≥—Ä–∞—Ñ–∏–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π. –£–¥–∞—á–∏ –≤—Å–µ–º! üìö‚úèÔ∏è",
            timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(), // 2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥
            likes: 24,
            comments: [
                { author: "–ò–≤–∞–Ω –°–∏–¥–æ—Ä–æ–≤", text: "–°–ø–∞—Å–∏–±–æ –∑–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ!", time: "1 —á–∞—Å –Ω–∞–∑–∞–¥" },
                { author: "–ê–Ω–Ω–∞ –ö–æ–∑–ª–æ–≤–∞", text: "–ë—É–¥–µ–º –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è!", time: "45 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥" }
            ],
            liked: false
        },
        {
            id: 2,
            author: {
                name: "–°–µ—Ä–≥–µ–π –ö–æ–∑–ª–æ–≤",
                class: "10–ë –∫–ª–∞—Å—Å",
                avatar: "https://ui-avatars.com/api/?name=–°–µ—Ä–≥–µ–π+–ö–æ–∑–ª–æ–≤&background=32CD32&color=fff&size=150"
            },
            content: "–ó–∞–≤—Ç—Ä–∞ –ø–æ—Å–ª–µ —É—Ä–æ–∫–æ–≤ —Ñ—É—Ç–±–æ–ª –Ω–∞ —à–∫–æ–ª—å–Ω–æ–º –ø–æ–ª–µ! –ö—Ç–æ —Å –Ω–∞–º–∏? –ü—Ä–∏–Ω–æ—Å–∏—Ç–µ —Å–º–µ–Ω–Ω—É—é —Ñ–æ—Ä–º—É! ‚öΩ",
            timestamp: new Date(Date.now() - 5 * 60 * 60 * 1000).toISOString(), // 5 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
            likes: 42,
            comments: [
                { author: "–î–º–∏—Ç—Ä–∏–π –í.", text: "–Ø –±—É–¥—É!", time: "4 —á–∞—Å–∞ –Ω–∞–∑–∞–¥" },
                { author: "–ê–ª–µ–∫—Å–µ–π –ù.", text: "–Ø —Ç–æ–∂–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—é—Å—å", time: "3 —á–∞—Å–∞ –Ω–∞–∑–∞–¥" },
                { author: "–ú–∞–∫—Å–∏–º –ü.", text: "–ì–æ–ª–∫–∏–ø–µ—Ä —É–∂–µ –µ—Å—Ç—å?", time: "2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥" }
            ],
            liked: false
        },
        {
            id: 3,
            author: {
                name: "–ê–Ω–Ω–∞ –ö–æ–≤–∞–ª–µ–≤–∞",
                class: "11–ê –∫–ª–∞—Å—Å",
                avatar: "https://ui-avatars.com/api/?name=–ê–Ω–Ω–∞+–ö–æ–≤–∞–ª–µ–≤–∞&background=FF69B4&color=fff&size=150"
            },
            content: "–ö—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–º–æ—á—å —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –≤—ã–ø—É—Å–∫–Ω–æ–≥–æ? –ù—É–∂–Ω—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ! üéì‚ú®",
            timestamp: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(), // 1 –¥–µ–Ω—å –Ω–∞–∑–∞–¥
            likes: 56,
            comments: [
                { author: "–ï–ª–µ–Ω–∞ –°.", text: "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å!", time: "20 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥" },
                { author: "–ü–∞–≤–µ–ª –ú.", text: "–ö–∞–∫–∞—è –ø–æ–º–æ—â—å –Ω—É–∂–Ω–∞?", time: "18 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥" }
            ],
            liked: true
        }
    ];
    
    AppState.posts = samplePosts;
}

function renderPosts() {
    const postsContainer = document.getElementById('postsContainer');
    if (!postsContainer) return;
    
    postsContainer.innerHTML = '';
    
    AppState.posts.forEach(post => {
        const postElement = createPostElement(post);
        postsContainer.appendChild(postElement);
    });
}

function createPostElement(post) {
    const postElement = document.createElement('div');
    postElement.className = 'post-card';
    postElement.dataset.id = post.id;
    
    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è
    const timeAgo = formatTimeAgo(new Date(post.timestamp));
    
    postElement.innerHTML = `
        <div class="post-header">
            <img src="${post.author.avatar}" alt="–ê–≤–∞—Ç–∞—Ä" class="post-author-avatar-small">
            <div class="post-author-info">
                <div class="post-author-name">
                    ${post.author.name}
                    <span class="author-class">${post.author.class}</span>
                </div>
                <div class="post-time">
                    <i class="far fa-clock"></i> ${timeAgo}
                </div>
            </div>
        </div>
        
        <div class="post-content">
            <p>${formatPostContent(post.content)}</p>
        </div>
        
        <div class="post-stats">
            <span><i class="fas fa-thumbs-up"></i> ${post.likes} –ª–∞–π–∫–æ–≤</span>
            <span>${post.comments.length} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</span>
        </div>
        
        <div class="post-actions-bar">
            <button class="post-action-btn ${post.liked ? 'active' : ''}" data-action="like">
                <i class="fas fa-thumbs-up"></i> ${post.liked ? '–í–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è' : '–ù—Ä–∞–≤–∏—Ç—Å—è'}
            </button>
            <button class="post-action-btn" data-action="comment">
                <i class="fas fa-comment"></i> –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
            </button>
            <button class="post-action-btn" data-action="share">
                <i class="fas fa-share"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
            </button>
        </div>
        
        <div class="comments-section">
            <div class="comment-input-container">
                <img src="https://ui-avatars.com/api/?name=${encodeURIComponent(AppState.currentUser?.fullName || 'User')}&background=6366f1&color=fff&size=150" 
                     alt="–ê–≤–∞—Ç–∞—Ä" class="comment-avatar">
                <div class="comment-input-wrapper">
                    <textarea class="comment-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
                    <button class="comment-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </div>
            
            <div class="comments-list">
                ${post.comments.map(comment => `
                    <div class="comment-item">
                        <img src="https://ui-avatars.com/api/?name=${encodeURIComponent(comment.author)}&background=6366f1&color=fff&size=150" 
                             alt="–ê–≤–∞—Ç–∞—Ä" class="comment-author-avatar">
                        <div class="comment-content">
                            <div class="comment-author-name">
                                ${comment.author}
                                <span class="comment-time">${comment.time}</span>
                            </div>
                            <div class="comment-text">${comment.text}</div>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    const likeBtn = postElement.querySelector('[data-action="like"]');
    const commentBtn = postElement.querySelector('[data-action="comment"]');
    const shareBtn = postElement.querySelector('[data-action="share"]');
    const commentSubmitBtn = postElement.querySelector('.comment-submit');
    const commentInput = postElement.querySelector('.comment-input');
    
    likeBtn.addEventListener('click', () => toggleLike(post.id));
    commentBtn.addEventListener('click', () => commentInput.focus());
    shareBtn.addEventListener('click', () => sharePost(post.id));
    commentSubmitBtn.addEventListener('click', () => addComment(post.id, commentInput.value));
    
    commentInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            addComment(post.id, commentInput.value);
        }
    });
    
    return postElement;
}

// ===== –§–£–ù–ö–¶–ò–ò –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø =====
function toggleLike(postId) {
    const post = AppState.posts.find(p => p.id === postId);
    if (!post) return;
    
    post.liked = !post.liked;
    post.likes += post.liked ? 1 : -1;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º UI
    const postElement = document.querySelector(`.post-card[data-id="${postId}"]`);
    if (postElement) {
        const likeBtn = postElement.querySelector('[data-action="like"]');
        const likesCount = postElement.querySelector('.post-stats span:first-child');
        
        likeBtn.classList.toggle('active', post.liked);
        likeBtn.innerHTML = `<i class="fas fa-thumbs-up"></i> ${post.liked ? '–í–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è' : '–ù—Ä–∞–≤–∏—Ç—Å—è'}`;
        likesCount.innerHTML = `<i class="fas fa-thumbs-up"></i> ${post.likes} –ª–∞–π–∫–æ–≤`;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â–∏–π —Å—á–µ—Ç—á–∏–∫ –ª–∞–π–∫–æ–≤
        updateLikesCount();
    }
}

function addComment(postId, text) {
    const commentText = text.trim();
    if (!commentText) return;
    
    const post = AppState.posts.find(p => p.id === postId);
    if (!post) return;
    
    const newComment = {
        author: AppState.currentUser?.fullName || AppState.currentUser?.username || '–ê–Ω–æ–Ω–∏–º',
        text: commentText,
        time: '–¢–æ–ª—å–∫–æ —á—Ç–æ'
    };
    
    post.comments.unshift(newComment);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º UI
    const postElement = document.querySelector(`.post-card[data-id="${postId}"]`);
    if (postElement) {
        const commentsList = postElement.querySelector('.comments-list');
        const commentInput = postElement.querySelector('.comment-input');
        
        // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
        commentInput.value = '';
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        const commentElement = document.createElement('div');
        commentElement.className = 'comment-item';
        commentElement.innerHTML = `
            <img src="https://ui-avatars.com/api/?name=${encodeURIComponent(newComment.author)}&background=6366f1&color=fff&size=150" 
                 alt="–ê–≤–∞—Ç–∞—Ä" class="comment-author-avatar">
            <div class="comment-content">
                <div class="comment-author-name">
                    ${newComment.author}
                    <span class="comment-time">${newComment.time}</span>
                </div>
                <div class="comment-text">${newComment.text}</div>
            </div>
        `;
        
        commentsList.insertBefore(commentElement, commentsList.firstChild);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        const commentsCount = postElement.querySelector('.post-stats span:last-child');
        commentsCount.textContent = `${post.comments.length} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤`;
    }
}

function sharePost(postId) {
    const post = AppState.posts.find(p => p.id === postId);
    if (!post) return;
    
    if (navigator.share) {
        navigator.share({
            title: `–ü–æ—Å—Ç –æ—Ç ${post.author.name}`,
            text: post.content.substring(0, 100) + '...',
            url: window.location.href
        });
    } else {
        alert('–§—É–Ω–∫—Ü–∏—è "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö');
    }
}

// ===== –î–†–£–ó–¨–Ø =====
function loadFriends() {
    const friendsGrid = document.getElementById('friendsGrid');
    if (!friendsGrid) return;
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥—Ä—É–∑–µ–π
    const sampleFriends = [
        { id: 1, name: "–ê–Ω–Ω–∞ –ö–æ–∑–ª–æ–≤–∞", class: "11–ê", avatar: "https://ui-avatars.com/api/?name=–ê–Ω–Ω–∞+–ö–æ–∑–ª–æ–≤–∞&background=FF69B4&color=fff&size=150" },
        { id: 2, name: "–î–º–∏—Ç—Ä–∏–π –í–æ–ª–∫–æ–≤", class: "11–ë", avatar: "https://ui-avatars.com/api/?name=–î–º–∏—Ç—Ä–∏–π+–í–æ–ª–∫–æ–≤&background=32CD32&color=fff&size=150" },
        { id: 3, name: "–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞", class: "10–ê", avatar: "https://ui-avatars.com/api/?name=–ï–ª–µ–Ω–∞+–°–∏–¥–æ—Ä–æ–≤–∞&background=FFA500&color=fff&size=150" },
        { id: 4, name: "–ú–∞–∫—Å–∏–º –ü–µ—Ç—Ä–æ–≤", class: "10–ë", avatar: "https://ui-avatars.com/api/?name=–ú–∞–∫—Å–∏–º+–ü–µ—Ç—Ä–æ–≤&background=4169E1&color=fff&size=150" },
        { id: 5, name: "–°–æ—Ñ–∏—è –ò–≤–∞–Ω–æ–≤–∞", class: "9–ê", avatar: "https://ui-avatars.com/api/?name=–°–æ—Ñ–∏—è+–ò–≤–∞–Ω–æ–≤–∞&background=8A2BE2&color=fff&size=150" },
        { id: 6, name: "–ü–∞–≤–µ–ª –ù–∏–∫–æ–ª–∞–µ–≤", class: "9–ë", avatar: "https://ui-avatars.com/api/?name=–ü–∞–≤–µ–ª+–ù–∏–∫–æ–ª–∞–µ–≤&background=DC143C&color=fff&size=150" },
        { id: 7, name: "–í–∏–∫—Ç–æ—Ä–∏—è –°–º–∏—Ä–Ω–æ–≤–∞", class: "8–ê", avatar: "https://ui-avatars.com/api/?name=–í–∏–∫—Ç–æ—Ä–∏—è+–°–º–∏—Ä–Ω–æ–≤–∞&background=20B2AA&color=fff&size=150" },
        { id: 8, name: "–ê—Ä—Ç–µ–º –ö—É–∑–Ω–µ—Ü–æ–≤", class: "8–ë", avatar: "https://ui-avatars.com/api/?name=–ê—Ä—Ç–µ–º+–ö—É–∑–Ω–µ—Ü–æ–≤&background=FF4500&color=fff&size=150" }
    ];
    
    AppState.friends = sampleFriends;
    AppState.onlineFriends = sampleFriends.slice(0, 4); // –ü–µ—Ä–≤—ã–µ 4 –æ–Ω–ª–∞–π–Ω
    
    renderFriends();
    renderOnlineFriends();
}

function renderFriends() {
    const friendsGrid = document.getElementById('friendsGrid');
    if (!friendsGrid) return;
    
    friendsGrid.innerHTML = '';
    
    AppState.friends.forEach(friend => {
        const friendElement = document.createElement('div');
        friendElement.className = 'friend-card';
        friendElement.innerHTML = `
            <img src="${friend.avatar}" alt="–ê–≤–∞—Ç–∞—Ä" class="friend-card-avatar">
            <div class="friend-card-name">${friend.name}</div>
            <div class="friend-card-class">${friend.class} –∫–ª–∞—Å—Å</div>
            <div class="friend-actions">
                <button class="btn btn-outline btn-small" data-action="message" data-id="${friend.id}">
                    <i class="fas fa-comment"></i>
                </button>
                <button class="btn btn-primary btn-small" data-action="profile" data-id="${friend.id}">
                    <i class="fas fa-user"></i>
                </button>
            </div>
        `;
        
        friendsGrid.appendChild(friendElement);
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –¥—Ä—É–∑–µ–π
    updateFriendsCount();
}

function renderOnlineFriends() {
    const onlineFriendsList = document.getElementById('onlineFriendsList');
    if (!onlineFriendsList) return;
    
    onlineFriendsList.innerHTML = '';
    
    AppState.onlineFriends.forEach(friend => {
        const friendElement = document.createElement('div');
        friendElement.className = 'friend-item';
        friendElement.innerHTML = `
            <img src="${friend.avatar}" alt="–ê–≤–∞—Ç–∞—Ä" class="friend-avatar">
            <div class="friend-info">
                <div class="friend-name">${friend.name}</div>
                <div class="friend-class">${friend.class} –∫–ª–∞—Å—Å</div>
            </div>
            <div class="online-status"></div>
        `;
        
        onlineFriendsList.appendChild(friendElement);
    });
}

// ===== –°–û–û–ë–©–ï–ù–ò–Ø =====
function loadMessages() {
    const messagesContainer = document.getElementById('messagesContainer');
    if (!messagesContainer) return;
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    const sampleMessages = [
        { id: 1, sender: "–ê–Ω–Ω–∞ –ö–æ–∑–ª–æ–≤–∞", text: "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?", time: "10:30", type: "received" },
        { id: 2, sender: "–í—ã", text: "–ü—Ä–∏–≤–µ—Ç! –í—Å—ë –æ—Ç–ª–∏—á–Ω–æ, –≥–æ—Ç–æ–≤–ª—é—Å—å –∫ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π", time: "10:32", type: "sent" },
        { id: 3, sender: "–ê–Ω–Ω–∞ –ö–æ–∑–ª–æ–≤–∞", text: "–Ø —Ç–æ–∂–µ. –ú–æ–∂–µ—Ç, –ø–æ–∑–∞–Ω–∏–º–∞–µ–º—Å—è –≤–º–µ—Å—Ç–µ?", time: "10:33", type: "received" },
        { id: 4, sender: "–í—ã", text: "–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è! –ö–æ–≥–¥–∞ —Å–º–æ–∂–µ—à—å?", time: "10:35", type: "sent" }
    ];
    
    AppState.messages = sampleMessages;
    renderMessages();
}

function renderMessages() {
    const messagesContainer = document.getElementById('messagesContainer');
    if (!messagesContainer) return;
    
    messagesContainer.innerHTML = '';
    
    AppState.messages.forEach(message => {
        const messageElement = document.createElement('div');
        messageElement.className = `message ${message.type}`;
        messageElement.textContent = message.text;
        messagesContainer.appendChild(messageElement);
    });
    
    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// ===== –§–û–¢–û =====
function loadPhotos() {
    const photosGrid = document.getElementById('photosGrid');
    if (!photosGrid) return;
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–æ—Ç–æ
    const samplePhotos = [
        { id: 1, url: "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80", author: "–ê–ª–µ–∫—Å–µ–π –ò.", date: "2 –¥–Ω—è –Ω–∞–∑–∞–¥" },
        { id: 2, url: "https://images.unsplash.com/photo-1524178234883-043d5c3f3cf4?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80", author: "–ú–∞—Ä–∏—è –ü.", date: "3 –¥–Ω—è –Ω–∞–∑–∞–¥" },
        { id: 3, url: "https://images.unsplash.com/photo-1546410531-bb4caa6b424d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80", author: "–°–µ—Ä–≥–µ–π –ö.", date: "5 –¥–Ω–µ–π –Ω–∞–∑–∞–¥" },
        { id: 4, url: "https://images.unsplash.com/photo-1523240795612-9a054b0db644?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80", author: "–ê–Ω–Ω–∞ –ö.", date: "1 –Ω–µ–¥–µ–ª—è –Ω–∞–∑–∞–¥" },
        { id: 5, url: "https://images.unsplash.com/photo-1523580494863-6f3031224c94?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80", author: "–î–º–∏—Ç—Ä–∏–π –í.", date: "2 –Ω–µ–¥–µ–ª–∏ –Ω–∞–∑–∞–¥" },
        { id: 6, url: "https://images.unsplash.com/photo-1522202176988-66273c2fd55f?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80", author: "–ï–ª–µ–Ω–∞ –°.", date: "2 –Ω–µ–¥–µ–ª–∏ –Ω–∞–∑–∞–¥" }
    ];
    
    AppState.photos = samplePhotos;
    renderPhotos();
}

function renderPhotos() {
    const photosGrid = document.getElementById('photosGrid');
    if (!photosGrid) return;
    
    photosGrid.innerHTML = '';
    
    AppState.photos.forEach(photo => {
        const photoElement = document.createElement('div');
        photoElement.className = 'photo-item';
        photoElement.innerHTML = `
            <img src="${photo.url}" alt="–§–æ—Ç–æ">
            <div class="photo-overlay">
                <div class="photo-author">${photo.author}</div>
                <div class="photo-date">${photo.date}</div>
            </div>
        `;
        
        photosGrid.appendChild(photoElement);
    });
}

// ===== –°–û–ë–´–¢–ò–Ø =====
function loadEvents() {
    const eventsList = document.getElementById('eventsList');
    if (!eventsList) return;
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è
    const sampleEvents = [
        { id: 1, title: "–í—ã–ø—É—Å–∫–Ω–æ–π –≤–µ—á–µ—Ä", date: new Date(Date.now() + 15 * 24 * 60 * 60 * 1000), location: "–ê–∫—Ç–æ–≤—ã–π –∑–∞–ª", participants: 45 },
        { id: 2, title: "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –¥–µ–Ω—å", date: new Date(Date.now() + 20 * 24 * 60 * 60 * 1000), location: "–®–∫–æ–ª—å–Ω—ã–π —Å—Ç–∞–¥–∏–æ–Ω", participants: 12 },
        { id: 3, title: "–ù–∞—É—á–Ω–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è", date: new Date(Date.now() + 25 * 24 * 60 * 60 * 1000), location: "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞", participants: 8 }
    ];
    
    AppState.events = sampleEvents;
    renderEvents();
}

function renderEvents() {
    const eventsList = document.getElementById('eventsList');
    if (!eventsList) return;
    
    eventsList.innerHTML = '';
    
    AppState.events.forEach(event => {
        const eventElement = document.createElement('div');
        eventElement.className = 'event-item';
        
        const day = event.date.getDate();
        const month = event.date.toLocaleString('ru', { month: 'short' });
        
        eventElement.innerHTML = `
            <div class="event-date">
                <span class="event-day">${day}</span>
                <span class="event-month">${month}</span>
            </div>
            <div class="event-details">
                <div class="event-title">${event.title}</div>
                <div class="event-time">${event.location}</div>
                <div class="event-time">${event.participants} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
            </div>
        `;
        
        eventsList.appendChild(eventElement);
    });
}

// ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====
function formatTimeAgo(date) {
    const now = new Date();
    const diffMs = now - date;
    const diffMins = Math.floor(diffMs / 60000);
    const diffHours = Math.floor(diffMs / 3600000);
    const diffDays = Math.floor(diffMs / 86400000);
    
    if (diffMins < 1) return '–¢–æ–ª—å–∫–æ —á—Ç–æ';
    if (diffMins < 60) return `${diffMins} –º–∏–Ω –Ω–∞–∑–∞–¥`;
    if (diffHours < 24) return `${diffHours} —á –Ω–∞–∑–∞–¥`;
    if (diffDays < 7) return `${diffDays} –¥–Ω –Ω–∞–∑–∞–¥`;
    return date.toLocaleDateString('ru');
}

function formatPostContent(content) {
    // –ó–∞–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –Ω–∞ <br>
    return content.replace(/\n/g, '<br>');
}

function updateFriendsCount() {
    const countElement = document.getElementById('friendsCount');
    if (countElement) {
        countElement.textContent = AppState.friends.length;
    }
}

function updatePostsCount() {
    const countElement = document.getElementById('postsCount');
    if (countElement) {
        countElement.textContent = AppState.posts.length;
    }
}

function updateLikesCount() {
    const countElement = document.getElementById('likesCount');
    if (countElement) {
        const totalLikes = AppState.posts.reduce((sum, post) => sum + post.likes, 0);
        countElement.textContent = totalLikes;
    }
}

// ===== –î–†–£–ì–ò–ï –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–ò =====
function initSearch() {
    const searchInput = document.querySelector('.search-input');
    if (!searchInput) return;
    
    searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            const query = this.value.trim();
            if (query) {
                alert(`–ü–æ–∏—Å–∫: ${query}`);
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–∏—Å–∫ –ø–æ –¥–∞–Ω–Ω—ã–º
            }
        }
    });
}

function initNotifications() {
    const notificationBtn = document.querySelector('.notification-btn');
    if (!notificationBtn) return;
    
    notificationBtn.addEventListener('click', function() {
        alert('–£ –≤–∞—Å 3 –Ω–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:\n\n1. –ê–Ω–Ω–∞ –¥–æ–±–∞–≤–∏–ª–∞ –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ\n2. –î–º–∏—Ç—Ä–∏–π –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –≤–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π\n3. –ó–∞–≤—Ç—Ä–∞ —à–∫–æ–ª—å–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ');
    });
}

function initUserMenu() {
    const userMenuBtn = document.getElementById('userMenuBtn');
    if (!userMenuBtn) return;
    
    userMenuBtn.addEventListener('click', function() {
        if (confirm('–•–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã?')) {
            sessionStorage.removeItem('schoolspace_session');
            window.location.href = 'index.html';
        }
    });
}

function loadInitialData() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–±—ã—Ç–∏—è
    loadEvents();
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å—Ç—ã
    loadPosts();
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥—Ä—É–∑–µ–π (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)
    if (AppState.currentTab === 'friends') {
        loadFriends();
    }
}

function showNotification(message, type = 'info') {
    // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        background: ${type === 'success' ? 'var(--success)' : 'var(--accent)'};
        color: white;
        padding: 15px 20px;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        z-index: 2000;
        animation: slideInRight 0.3s ease-out;
    `;
    
    notification.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i>
        ${message}
    `;
    
    document.body.appendChild(notification);
    
    // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease-out';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

// –î–æ–±–∞–≤–ª—è–µ–º CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
const style = document.createElement('style');
style.textContent = `
    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    @keyframes slideOutRight {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
    
    .notification {
        display: flex;
        align-items: center;
        gap: 10px;
    }
`;
document.head.appendChild(style);

// ===== –û–ë–†–ê–ë–û–¢–ö–ê –ë–´–°–¢–†–´–• –î–ï–ô–°–¢–í–ò–ô =====
document.addEventListener('click', function(e) {
    if (e.target.closest('.action-button')) {
        const button = e.target.closest('.action-button');
        const action = button.getAttribute('data-action');
        
        switch(action) {
            case 'create-post':
                document.getElementById('postInput')?.focus();
                break;
            case 'create-event':
                alert('–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
                break;
            case 'create-poll':
                alert('–°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
                break;
            case 'settings':
                alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
                break;
        }
    }
    
    if (e.target.closest('#editProfileBtn')) {
        alert('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
    }
});

// –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
setTimeout(loadInitialData, 500);
